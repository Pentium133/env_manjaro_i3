#! /bin/bash

##
# Examples:
#   local arr=(1 2 3 4 5)
#   
#   map $arr echo                   # print each element
#   map $arr 'inc $e 10'            # increment each element by `10`
#   map $arr 'decorate $e "[" "]"'  # decorate each element by `[` and `]`
##
function map(){
  local args=("$@")
  local length=$((${#args[@]}-1))
  local iterable=(${args:0:$length})
  local funName=${args:$length}

  #log_info "iterable=$iterable"
  #log_info "function=$funName"

  for e in $iterable; do
    eval "$funName $e"
  done
}

function mkstring(){
  local arr=()
  local delim
  local left
  local right

  for i in "$@"; do
    case $i in
      -d=*|--delim=*)
        delim="${i#*=}"
        shift
        ;;
      -l=*|--left=*)
        left="${i#*=}"
        shift
        ;;
      -r=*|--right=*)
        right="${i#*=}"
        shift
        ;;
      *)
        arr+="${i}"
        shift
      ;;
    esac
  done

  local str=""
  for e in $arr; do
    str="${e}${delim}${str}"
  done

  local delim_length=$(strlen $delim)
  str=$(strdrop_right "$str" $delim_length)
 
  echo $(strdecorate $str $left $right)
}


